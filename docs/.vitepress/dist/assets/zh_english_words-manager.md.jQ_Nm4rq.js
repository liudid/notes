import{Z as N,a as w,p as _,q as g,T as t,O as n,ag as f,m,S as u,F as k,a7 as U,M as D,a8 as M,n as Z,R as G}from"./chunks/framework.0sBu8sKU.js";import{w as H}from"./chunks/words.5-nW66lE.js";import{E as x}from"./chunks/theme.dhLpOEdn.js";const Q={style:{width:"100%","margin-bottom":"10px"}},X={style:{width:"100%"}},Y={style:{width:"100%",border:"1px solid #000",padding:"10px","margin-bottom":"10px"}},ee={style:{width:"100%"}},te={class:"dialog-footer"},se=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"zh/english/words-manager.md","filePath":"zh/english/words-manager.md"}'),oe={name:"zh/english/words-manager.md"},de=Object.assign(oe,{setup(le){const E=N([]),v=w(!1);console.log(1);const o=N({word:"",definitions:[{desc:""}],compose:{prefix:"",root:"",suffix:""},examples:[{sentence:"",explanation:"",highlight:""}],furthers:[]}),y={ADD:Symbol(),UPDATE:Symbol()},b=w(null),S=w(0);async function O(){const l=await(await fetch("http://localhost:9292/api/words")).json();Object.assign(E,l.words)}O();function P(){b.value=y.ADD,v.value=!0}async function j(r,l){const a=new URLSearchParams;a.append("index",l),await fetch("http://localhost:9292/api/word-delete?"+a.toString())}async function R(r,l){v.value=!0,b.value=y.UPDATE;const a=new URLSearchParams;a.append("word",r.word);let i=await(await fetch("http://localhost:9292/api/word-get?"+a.toString())).json();i.definitions=i.definitions.map(s=>({desc:s})),i.examples.forEach(s=>{s.sentence=s.sentence.replace(/\{([^}]+)\}/g,"$1")}),i.furthers=i.furthers.map(s=>({item:s})),Object.assign(o,i),S.value=l}function A(r){o.definitions.push({desc:""})}function I(r){if(o.definitions.length<=1)return x.error("至少有一个");o.definitions.splice(r,1)}function z(r){o.examples.push({sentence:"",explanation:"",highlight:""})}function B(r){if(o.examples.length<=1)return x.error("至少有一个");o.examples.splice(r,1)}const T=w(null),C=w(!1),V=w("");function J(){C.value=!0,Z(()=>{var r,l;(l=(r=T.value)==null?void 0:r.input)==null||l.focus()})}function $(){V.value&&o.furthers.push({item:V.value}),C.value=!1,V.value=""}function q(r){o.furthers.splice(r,1)}async function F(){if(o.word.trim()==="")return x.error("请填写word");if(o.definitions.filter(d=>d.desc.trim()==="").length)return x.error("请填写definition");if(o.examples.filter(d=>d.sentence.trim()===""||d.explanation.trim()===""||d.highlight.trim()==="").length)return x.error("请填写example");const a={word:o.word,definitions:o.definitions.map(d=>d.desc),compose:o.compose,examples:o.examples,furthers:o.furthers.map(d=>d.item)};if(b.value===y.ADD){if(H.map(i=>i.word).includes(a.word))return x.error("word已存在！");a.examples.forEach(i=>{const s=new RegExp(`\\b${i.highlight}\\b`,"g");i.sentence=i.sentence.replace(s,`{${i.highlight}}`)}),await fetch("http://localhost:9292/api/word-add",{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify(a)})}else if(b.value===y.UPDATE){const d=JSON.parse(JSON.stringify(a));d.activeIndex=S.value,d.examples.forEach(i=>{const s=new RegExp(`\\b${i.highlight}\\b`,"g");i.sentence=i.sentence.replace(s,`{${i.highlight}}`)}),await fetch("http://localhost:9292/api/word-update",{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify(d)})}}return(r,l)=>{const a=f("el-button"),d=f("el-table-column"),i=f("el-table"),s=f("el-input"),h=f("el-form-item"),L=f("el-tag"),W=f("el-form"),K=f("el-dialog");return m(),_("div",null,[g("div",null,[t(a,{onClick:P},{default:n(()=>[u("添加")]),_:1})]),t(i,{border:"",data:E,stripe:"",style:{width:"100%"}},{default:n(()=>[t(d,{type:"index",label:"序号",width:"100"}),t(d,{prop:"word",label:"word",width:"180"}),t(d,{prop:"address",label:"操作"},{default:n(({row:e,$index:c})=>[t(a,{onClick:p=>R(e,c)},{default:n(()=>[u("编辑")]),_:2},1032,["onClick"]),t(a,{onClick:p=>j(e,c)},{default:n(()=>[u("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(K,{modelValue:v.value,"onUpdate:modelValue":l[8]||(l[8]=e=>v.value=e),title:"w",width:"700"},{footer:n(()=>[g("div",te,[t(a,{onClick:l[7]||(l[7]=e=>v.value=!1)},{default:n(()=>[u("Cancel")]),_:1}),t(a,{type:"primary",onClick:F},{default:n(()=>[u(" Confirm ")]),_:1})])]),default:n(()=>[t(W,{model:o,"label-width":"auto",style:{"max-width":"600px"}},{default:n(()=>[t(h,{label:"word",required:""},{default:n(()=>[t(s,{modelValue:o.word,"onUpdate:modelValue":l[0]||(l[0]=e=>o.word=e)},null,8,["modelValue"])]),_:1}),t(h,{label:"definitions",required:""},{default:n(()=>[(m(!0),_(k,null,U(o.definitions,(e,c)=>(m(),_("div",Q,[t(s,{modelValue:e.desc,"onUpdate:modelValue":p=>e.desc=p},null,8,["modelValue","onUpdate:modelValue"]),t(a,{type:"danger",onClick:p=>I(c)},{default:n(()=>[u("删除")]),_:2},1032,["onClick"])]))),256)),g("div",X,[t(a,{type:"primary",onClick:l[1]||(l[1]=e=>A(r.index))},{default:n(()=>[u("添加")]),_:1})])]),_:1}),t(h,{label:"compose-prefix"},{default:n(()=>[t(s,{modelValue:o.compose.prefix,"onUpdate:modelValue":l[2]||(l[2]=e=>o.compose.prefix=e)},null,8,["modelValue"])]),_:1}),t(h,{label:"compose-root"},{default:n(()=>[t(s,{modelValue:o.compose.root,"onUpdate:modelValue":l[3]||(l[3]=e=>o.compose.root=e)},null,8,["modelValue"])]),_:1}),t(h,{label:"compose-suffix"},{default:n(()=>[t(s,{modelValue:o.compose.suffix,"onUpdate:modelValue":l[4]||(l[4]=e=>o.compose.suffix=e)},null,8,["modelValue"])]),_:1}),t(h,{label:"examples",required:""},{default:n(()=>[(m(!0),_(k,null,U(o.examples,(e,c)=>(m(),_("div",Y,[g("div",null,[u(" sentence:"),t(s,{type:"textarea",modelValue:e.sentence,"onUpdate:modelValue":p=>e.sentence=p},null,8,["modelValue","onUpdate:modelValue"])]),g("div",null,[u(" explanation:"),t(s,{type:"textarea",modelValue:e.explanation,"onUpdate:modelValue":p=>e.explanation=p},null,8,["modelValue","onUpdate:modelValue"])]),g("div",null,[u(" highlight:"),t(s,{modelValue:e.highlight,"onUpdate:modelValue":p=>e.highlight=p},null,8,["modelValue","onUpdate:modelValue"])]),g("div",ee,[t(a,{type:"danger",onClick:p=>B(c)},{default:n(()=>[u("删除")]),_:2},1032,["onClick"])])]))),256)),t(a,{type:"primary",onClick:l[5]||(l[5]=e=>z(r.index))},{default:n(()=>[u("添加")]),_:1})]),_:1}),t(h,{label:"furthers"},{default:n(()=>[(m(!0),_(k,null,U(o.furthers,(e,c)=>(m(),D(L,{key:e.item,closable:"","disable-transitions":!1,onClose:p=>q(c)},{default:n(()=>[u(G(e.item),1)]),_:2},1032,["onClose"]))),128)),C.value?(m(),D(s,{key:0,ref_key:"InputRef",ref:T,modelValue:V.value,"onUpdate:modelValue":l[6]||(l[6]=e=>V.value=e),class:"w-20",size:"small",onKeyup:M($,["enter"]),onBlur:$},null,8,["modelValue"])):(m(),D(a,{key:1,class:"button-new-tag",size:"small",onClick:J},{default:n(()=>[u(" + New Further ")]),_:1}))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{se as __pageData,de as default};
